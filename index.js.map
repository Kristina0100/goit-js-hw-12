{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryTemplate = imgData => {\n  return `\n  <li class=\"gallery-card\">\n  <a class=\"gallery-link\" href=${imgData.largeImageURL}>\n    <img class=\"gallery-img\" src=\"${imgData.webformatURL}\" alt=\"${imgData.tags}\" data-source=${imgData.largeImageURL} />\n  </a>\n<div class=\"data-wrapper\">\n<ul class=\"img-info\">\n  <li class=\"param-info\">\n  <h2 class=\"param-name\">Likes</h2>\n  <p class=\"param-value\">${imgData.likes}</p></li>\n  <li class=\"param-info\">\n  <h2 class=\"param-name\">Views</h2>\n  <p class=\"param-value\">${imgData.views}</p></li>\n  <li class=\"param-info\">\n  <h2 class=\"param-name\">Comments</h2>\n  <p class=\"param-value\">${imgData.comments}</p></li>\n  <li class=\"param-info\">\n  <h2 class=\"param-name\">Downloads</h2>\n  <p class=\"param-value\">${imgData.downloads}</p></li>\n</ul>\n</div>\n  </li>\n  `;\n};","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport const fetchPhotos = (searchedValue, page) => {\n  const axiosParams = {\n    params: {\n      key: '30578441-e990d3db57773391ef0ba167f',\n      q: searchedValue,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 15,\n    },\n};\n\n  return axios.get(`/api/`, axiosParams);\n};","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { createGalleryTemplate } from '/js/render-functions';\nimport { fetchPhotos } from '/js/pixabay-api';\n\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreBtnEl = document.querySelector('.js-load-btn');\nconst observeredEl = document.querySelector('.js-observered-element');\n\nlet currentPage = 1;\nlet inputValue = '';\n\nconst observerOptions = {\n  root: null,\n  rootMargin: '0px 0px 400px 0px',\n  threshold: 1,\n};\n\nconst observerCallBack = async entries => {\n  if (entries[0].isIntersecting) {\n    try {\n      currentPage++;\n\n      const response = await fetchPhotos(inputValue, currentPage);\n\n         const galleryCardsTemplate = response.data.hits.map(imgInfo => createGalleryTemplate(imgInfo)).join('');\n\n      galleryEl.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n\n      if (currentPage === response.data.totalHits) {\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  }\n};\n\nconst observer = new IntersectionObserver(observerCallBack, observerOptions);\n\nconst onFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    inputValue = searchFormEl.elements.query.value.trim();\n    currentPage = 1;\n    loadMoreBtnEl.classList.add('is-hidden');\n\n    if (!inputValue) {\n      iziToast.warning({\n        message: 'Please enter a search term',\n        position: 'topRight',\n        closeOnClick: true,\n      });\n      return;\n    }\n\n    loaderEl.classList.remove(\"is-hidden\");\n    galleryEl.innerHTML = '';\n\n    const response = await fetchPhotos(inputValue, currentPage);\n\n    if (response.data.hits.length === 0) {\n      iziToast.show({\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        messageColor: '#fff',\n        messageSize: '16px',\n        messageLineHeight: '24px',\n        iconUrl: '/img/error.svg',\n        backgroundColor: '#EF4040',\n        maxWidth: '350px',\n        closeOnClick: true,\n        position: 'topRight',\n        progressBarColor: '#B51B1B',\n      });\n\n      loaderEl.classList.add(\"is-hidden\");\n      galleryEl.innerHTML = '';\n\n      return\n    };\n\n    loaderEl.classList.add(\"is-hidden\");\n\n    const galleryCardsTemplate = response.data.hits.map(imgInfo => createGalleryTemplate(imgInfo)).join('');\n    galleryEl.innerHTML = galleryCardsTemplate;\n    loadMoreBtnEl.classList.remove('is-hidden');\n                \n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n\n    lightbox.refresh();\n\n    observer.observe(observeredEl);\n\n  }  catch(err) {\n\n      iziToast.show({\n      title: 'Error',\n      message: `Something went wrong. Please try again later.`,\n      messageColor: '#fff',\n      titleColor: '#fff',\n      messageSize: '16px',\n      messageLineHeight: '24px',\n      position: 'topRight',\n      closeOnClick: true,\n      maxWidth: '420px',\n      backgroundColor: '#EF4040',\n      progressBarColor: '#B51B1B',\n      iconUrl: '/img/error.svg',\n    });\n\n      loaderEl.classList.add(\"is-hidden\");\n  };\n\n};\n\nconst onLoadBtnClick = async event => {\n  try {\n    currentPage++;\n    const response = await fetchPhotos(inputValue, currentPage);\n\n    const galleryCardsTemplate = response.data.hits.map(imgInfo => createGalleryTemplate(imgInfo)).join('');\n    galleryEl.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n    });\n\n    lightbox.refresh();\n\n    //     scrollBy({\n    //   top: cardHeight * 2,\n    //   behavior: 'smooth',\n    // });\n\n    if (currentPage === response.data.totalHits) {\n    loadMoreBtnEl.classList.add('is-hidden');\n\n    iziToast.show({\n    message: `We're sorry, but you've reached the end of search results.`,\n    messageColor: '#fff',\n    titleColor: '#fff',\n    messageSize: '16px',\n    messageLineHeight: '24px',\n    position: 'topRight',\n    closeOnClick: true,\n    maxWidth: '350px',\n    backgroundColor: '#6c8cff',\n    progressBarColor: '#4e75ff',\n    iconUrl: '/img/sad_face.svg',\n    });\n  };\n\n  } catch (err) {\n  };\n};\n\nsearchFormEl.addEventListener('submit', onFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadBtnClick);\n"],"names":["createGalleryTemplate","imgData","axios","fetchPhotos","searchedValue","page","axiosParams","searchFormEl","galleryEl","loaderEl","loadMoreBtnEl","observeredEl","currentPage","inputValue","observerOptions","observerCallBack","entries","response","galleryCardsTemplate","imgInfo","err","observer","onFormSubmit","event","iziToast","SimpleLightbox","onLoadBtnClick"],"mappings":"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"}