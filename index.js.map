{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryTemplate = imgData => {\n  return `\n  <li class=\"gallery-card\">\n  <a class=\"gallery-link\" href=${imgData.largeImageURL}>\n    <img class=\"gallery-img\" src=\"${imgData.webformatURL}\" alt=\"${imgData.tags}\" data-source=${imgData.largeImageURL} />\n  </a>\n<div class=\"data-wrapper\">\n<ul class=\"img-info\">\n  <li class=\"param-info\">\n  <h2 class=\"param-name\">Likes</h2>\n  <p class=\"param-value\">${imgData.likes}</p></li>\n  <li class=\"param-info\">\n  <h2 class=\"param-name\">Views</h2>\n  <p class=\"param-value\">${imgData.views}</p></li>\n  <li class=\"param-info\">\n  <h2 class=\"param-name\">Comments</h2>\n  <p class=\"param-value\">${imgData.comments}</p></li>\n  <li class=\"param-info\">\n  <h2 class=\"param-name\">Downloads</h2>\n  <p class=\"param-value\">${imgData.downloads}</p></li>\n</ul>\n</div>\n  </li>\n  `;\n};","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport const fetchPhotos = (searchedValue, page) => {\n  const axiosParams = {\n    params: {\n      key: '30578441-e990d3db57773391ef0ba167f',\n      q: searchedValue,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 15,\n    },\n};\n\n  return axios.get(`/api/`, axiosParams);\n};","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { createGalleryTemplate } from '/js/render-functions';\nimport { fetchPhotos } from '/js/pixabay-api';\n\nconst errorIcon = '/img/error.svg';\nconst warningIcon = '/img/warning.svg';\nconst sadFaceIcon = '/img/sad_face.svg';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreBtnEl = document.querySelector('.js-load-btn');\n\nlet currentPage = 1;\nlet inputValue = '';\nlet cardHeight = 0;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst checkEndOfResults = totalHits => {\n  const totalLoadedPhotos = currentPage * 15;\n  if (totalLoadedPhotos >= totalHits) {\n    loadMoreBtnEl.classList.add('is-hidden');\n    iziToast.show({\n      message: `We're sorry, but you've reached the end of search results.`,\n      messageColor: '#fff',\n      titleColor: '#fff',\n      messageSize: '16px',\n      messageLineHeight: '24px',\n      position: 'topRight',\n      closeOnClick: true,\n      maxWidth: '350px',\n      backgroundColor: '#6c8cff',\n      progressBarColor: '#4e75ff',\n      iconUrl: sadFaceIcon,\n    });\n  };\n};\n\nconst showErrorMessage = () => {\n  iziToast.show({\n    title: 'Error',\n    message: `Something went wrong. Please try again later.`,\n    messageColor: '#fff',\n    titleColor: '#fff',\n    messageSize: '16px',\n    messageLineHeight: '24px',\n    position: 'topRight',\n    closeOnClick: true,\n    maxWidth: '420px',\n    backgroundColor: '#EF4040',\n    progressBarColor: '#B51B1B',\n    iconUrl: '/img/error.svg',\n  });\n};\n\nconst onFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    inputValue = searchFormEl.elements.query.value.trim();\n    currentPage = 1;\n    loadMoreBtnEl.classList.add('is-hidden');\n\n    if (!inputValue) {\n      iziToast.show({\n        message: 'Please enter a search term',\n        messageColor: '#fff',\n        messageSize: '16px',\n        messageLineHeight: '24px',\n        iconColor: '#fff',\n        iconUrl: warningIcon,\n        backgroundColor: '#FC7A66',\n        position: 'topRight',\n        closeOnClick: true,\n      });\n      return;\n    };\n\n    loaderEl.classList.remove(\"is-hidden\");\n    galleryEl.innerHTML = '';\n\n    const response = await fetchPhotos(inputValue, currentPage);\n\n    if (response.data.hits.length === 0) {\n      iziToast.show({\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        messageColor: '#fff',\n        messageSize: '16px',\n        messageLineHeight: '24px',\n        iconUrl: errorIcon,\n        backgroundColor: '#EF4040',\n        maxWidth: '350px',\n        closeOnClick: true,\n        position: 'topRight',\n        progressBarColor: '#B51B1B',\n      });\n\n      loaderEl.classList.add(\"is-hidden\");\n      galleryEl.innerHTML = '';\n\n      return\n    };\n\n    loaderEl.classList.add(\"is-hidden\");\n\n    const galleryCardsTemplate = response.data.hits.map(imgInfo => createGalleryTemplate(imgInfo)).join('');\n    galleryEl.innerHTML = galleryCardsTemplate;\n    loadMoreBtnEl.classList.remove('is-hidden');\n\n    const galleryCardEl = galleryEl.querySelector('li');\n    cardHeight = galleryCardEl.getBoundingClientRect().height;\n\n    lightbox.refresh();\n\n   checkEndOfResults(response.data.totalHits);\n\n  }  catch(err) {\n    showErrorMessage();\n    loaderEl.classList.add(\"is-hidden\");\n  };\n\n};\n\nconst onLoadBtnClick = async event => {\n  try {\n    loaderEl.classList.remove('is-hidden'); \n\n    currentPage++;\n    const response = await fetchPhotos(inputValue, currentPage);\n\n    const galleryCardsTemplate = response.data.hits.map(imgInfo => createGalleryTemplate(imgInfo)).join('');\n    galleryEl.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n\n    lightbox.refresh();\n\n    scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    checkEndOfResults(response.data.totalHits);\n    loaderEl.classList.add('is-hidden');\n\n  } catch (err) {\n    showErrorMessage();\n  };\n};\n\nsearchFormEl.addEventListener('submit', onFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadBtnClick);\n"],"names":["createGalleryTemplate","imgData","axios","fetchPhotos","searchedValue","page","axiosParams","errorIcon","warningIcon","sadFaceIcon","searchFormEl","galleryEl","loaderEl","loadMoreBtnEl","currentPage","inputValue","cardHeight","lightbox","SimpleLightbox","checkEndOfResults","totalHits","iziToast","showErrorMessage","onFormSubmit","event","response","galleryCardsTemplate","imgInfo","onLoadBtnClick"],"mappings":"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"}